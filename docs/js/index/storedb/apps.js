var allAppsRaw=[],allAppsSorted={};const appsListElement=document.getElementById("apps-list");var appDownloadsModal={controller:new BulmaModal("#app-download-modal"),content:{name:document.getElementById("app-download-modal-app-name"),icon:document.getElementById("app-download-modal-app-icon"),qrcode:document.getElementById("app-download-modal-app-download-qrcode")},buttons:{download:document.getElementById("app-download-modal-download-button")}};appDownloadsModal.buttons.download.onclick=function(e){window.open(e.target.getAttribute("data-app-download"),"_blank")};var appDetailsModal={controller:new BulmaModal("#app-details-modal"),content:{name:document.getElementById("app-details-modal-app-name"),icon:document.getElementById("app-details-modal-app-icon"),screenshots:{container:document.getElementById("app-details-modal-app-screenshots-container"),columns:document.getElementById("app-details-modal-app-screenshots")},description:document.getElementById("app-details-modal-app-description"),categories:document.getElementById("app-details-modal-app-categories"),maintainer:document.getElementById("app-details-modal-app-maintainer"),version:document.getElementById("app-details-modal-app-version"),type:document.getElementById("app-details-modal-app-type"),has_ads:document.getElementById("app-details-modal-app-has_ads"),has_tracking:document.getElementById("app-details-modal-app-has_tracking"),license:document.getElementById("app-details-modal-app-license")},buttons:{download:document.getElementById("app-details-modal-download-button"),donation:document.getElementById("app-details-modal-donation-button")}};function addAppCard(e){appsListElement.appendChild(document.createElement("br"));var a=document.createElement("div");a.classList.add("card"),appsListElement.appendChild(a);var t=document.createElement("div");t.classList.add("card-content"),a.appendChild(t);var n=document.createElement("div");n.classList.add("media"),t.appendChild(n);var o=document.createElement("div");o.classList.add("media-left"),n.appendChild(o);var d=document.createElement("figure");d.classList.add("image","is-48x48","is-unselectable");var l=document.createElement("img");l.src=e.icon,d.appendChild(l),o.appendChild(d);var s=document.createElement("div");s.classList.add("media-content"),n.appendChild(s);var i=document.createElement("p");i.classList.add("title","is-4"),i.innerText=e.name,s.appendChild(i);var p=document.createElement("p");p.classList.add("subtitle","is-6");var c="";for(const a of e.categories){const e=allCategories[a].name;c+=e?e+" ":a}p.innerText=c,s.appendChild(p);var r=document.createElement("div");r.classList.add("content"),r.innerText=e.description,t.appendChild(r);var m=document.createElement("footer");m.classList.add("card-footer"),a.appendChild(m);var u=document.createElement("a");u.classList.add("card-footer-item","is-unselectable","app"),u.setAttribute("data-app-categories",e.categories.toString()),u.setAttribute("data-app-name",e.name),u.innerText="View app details",m.appendChild(u)}function loadAppsFromCategories(){var e=[];function a(a,t){const n=allAppsSorted[a][t];addAppCard({icon:n.icon,name:n.name,description:n.description,categories:n.meta.categories}),e.push(n.name)}if(document.getElementById("loading-progress").removeAttribute("value"),appsListElement.innerHTML="","all"===selectedCategory)for(const t in allCategories)for(const n in allAppsSorted[t])e.includes(n)||a(t,n);else if(selectedCategory in allAppsSorted)for(const t in allAppsSorted[selectedCategory])e.includes(t)||a(selectedCategory,t);document.getElementById("loading-progress").setAttribute("value",0)}appDetailsModal.controller.addEventListener("modal:show",(function(){document.getElementsByTagName("html")[0].classList.add("is-clipped")})),appDetailsModal.controller.addEventListener("modal:close",(function(){document.getElementsByTagName("html")[0].classList.remove("is-clipped")})),appDetailsModal.buttons.download.onclick=function(e){appDownloadsModal.controller.show()},appDetailsModal.buttons.donation.onclick=function(e){window.open(e.target.getAttribute("data-app-donate"),"_blank")},appsListElement.onclick=function(e){if(e.target.classList.contains("app")){const d=e.target.getAttribute("data-app-categories").split(",")[0];if(d in allAppsSorted){const l=allAppsSorted[d][e.target.getAttribute("data-app-name")];if(l){if(l.name?(appDetailsModal.content.name.innerText=l.name,appDownloadsModal.content.name.innerText=l.name):(appDetailsModal.content.name.innerText="Unknown app name",appDownloadsModal.content.name.innerText="Unknown app name"),l.icon?(appDetailsModal.content.icon.src=l.icon,appDownloadsModal.content.icon.src=l.icon):(appDetailsModal.content.icon.src="icons/default-icon.png",appDownloadsModal.content.icon.src="icons/default-icon.png"),l.screenshots)for(var a of(appDetailsModal.content.screenshots.container.style.display="initial",appDetailsModal.content.screenshots.columns.innerHTML="",l.screenshots)){var t=document.createElement("div");t.classList.add("column","is-half"),appDetailsModal.content.screenshots.columns.appendChild(t);var n=document.createElement("img");n.src=a,t.appendChild(n)}else appDetailsModal.content.screenshots.container.style.display="none";if(l.description?appDetailsModal.content.description.innerText=l.description:appDetailsModal.content.description.innerText="No description.",l.meta.categories){var o="";for(const e of l.meta.categories){const a=allCategories[e].name;o+=a?a+" ":e}appDetailsModal.content.categories.innerHTML="Categories: <b>"+o+"</b>"}else appDetailsModal.content.categories.innerHTML="Categories: <b>unknown</b>";l.author?appDetailsModal.content.maintainer.innerHTML="Author(s): <b>"+l.author+"</b>":l.maintainer?appDetailsModal.content.maintainer.innerHTML="Maintainer(s): <b>"+l.maintainer+"</b>":appDetailsModal.content.maintainer.innerHTML="Authors/maintainers: <b>unknown</b>",l.download.version?appDetailsModal.content.version.innerHTML="Version: <b>"+l.download.version+"</b>":appDetailsModal.content.version.innerHTML="Version: <b>unknown</b>",l.type?appDetailsModal.content.type.innerHTML="Type: <b>"+l.type+"</b>":appDetailsModal.content.type.innerHTML="Type: <b>unknown</b>",void 0!==l.has_ads?appDetailsModal.content.has_ads.innerHTML="Ads: <b>"+l.has_ads+"</b>":appDetailsModal.content.has_ads.innerHTML="Ads: <b>unknown</b>",void 0!==l.has_tracking?appDetailsModal.content.has_tracking.innerHTML="Tracking: <b>"+l.has_tracking+"</b>":appDetailsModal.content.has_tracking.innerHTML="Tracking: <b>unknown</b>",l.license?appDetailsModal.content.license.innerHTML="License: <b>"+l.license+"</b>":appDetailsModal.content.license.innerHTML="License: <b>unknown</b>",l.download.url?(appDetailsModal.buttons.download.style.display="initial",appDetailsModal.buttons.download.setAttribute("data-app-download",l.download.url),appDownloadsModal.buttons.download.style.display="initial",appDownloadsModal.buttons.download.setAttribute("data-app-download",l.download.url),appDownloadsModal.content.qrcode.innerHTML="",new QRCode(appDownloadsModal.content.qrcode,l.download.url)):(appDetailsModal.buttons.download.style.display="none",appDownloadsModal.buttons.download.style.display="none"),l.donation?(appDetailsModal.buttons.donation.style.display="initial",appDetailsModal.buttons.donation.setAttribute("data-app-donate",l.donation)):appDetailsModal.buttons.donation.style.display="none",appDetailsModal.controller.show()}else bulmaToast.toast({message:'App does not exist in category "'+d+'"!',type:"is-danger",position:"top-center",closeOnClick:!0,pauseOnHover:!0,animate:toastAnimateOptions})}else bulmaToast.toast({message:'Given category "'+d+'" does not exist!',type:"is-danger",position:"top-center",closeOnClick:!0,pauseOnHover:!0,animate:toastAnimateOptions})}};